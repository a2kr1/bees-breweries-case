
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Documenta√ß√£o - BEES Breweries Case</title>
    <style>
        body {
            background-color: #FFF8F0;
            font-family: 'Segoe UI', sans-serif;
            margin: 2rem;
            color: #595959;
        }
        h1, h2, h3 {
            color: #7C0A02;
        }
        code {
            background-color: #f4f4f4;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 90%;
        }
        pre {
            background-color: #f9f9f9;
            padding: 1rem;
            border-left: 5px solid #D6A900;
            overflow-x: auto;
        }
        a {
            color: #593C1F;
        }
        footer {
            margin-top: 3rem;
            font-size: 0.9rem;
            color: #595959;
        }
    </style>
</head>
<body>
<main>
<h1>üç∫ BEES Breweries Case</h1>

<p>Este projeto implementa uma solu√ß√£o completa para o case t√©cnico da vaga de Engenheiro de Dados S√™nior na BEES.</p>

<p>A arquitetura segue o padr√£o <strong>Medallion (Bronze, Silver, Gold)</strong>, com orquestra√ß√£o em <strong>Airflow</strong>, processamento com <strong>PySpark e Delta Lake</strong>, testes automatizados, EDA e verifica√ß√£o de qualidade, tudo containerizado via <strong>Docker</strong>.</p>

<hr />

<h2>üìÑ Escopo oficial do case</h2>

<ol>
<li>Consumir dados da API Open Brewery DB</li>
<li>Aplicar arquitetura Medallion (Bronze, Silver, Gold)</li>
<li>Persist√™ncia em Data Lake particionado por data e localiza√ß√£o</li>
<li>Orquestra√ß√£o com Airflow</li>
<li>Testes automatizados e EDA</li>
<li>Logging estruturado com tratamento de erros</li>
<li>Containeriza√ß√£o com Docker</li>
<li>Verifica√ß√£o e valida√ß√£o de tabelas com <code>verify_all.py</code></li>
<li>README completo com trade-offs e instru√ß√µes</li>
</ol>

<hr />

<h2>‚úÖ Entregas implementadas</h2>

<p>| Requisito                                   | Status ‚úÖ | Local / Detalhes                                                   |
|--------------------------------------------|-----------|----------------------------------------------------------------------|
| Ingest√£o da API Open Brewery DB            | ‚úÖ         | <code>scripts/run_bronze.py</code>, <code>src/api_client.py</code>                        |
| Arquitetura Bronze ‚Üí Silver ‚Üí Gold         | ‚úÖ         | <code>data/{bronze,silver,gold}</code>                                         |
| Particionamento por <code>state</code> e <code>processing_date</code> | ‚úÖ         | Camadas Silver e Gold particionadas corretamente                     |
| PySpark + Delta Lake                       | ‚úÖ         | <code>src/transform.py</code>, <code>.write.format("delta")</code>                      |
| Orquestra√ß√£o com Airflow                   | ‚úÖ         | DAG em <code>airflow/dags/brewery_dag.py</code>                                |
| Logging estruturado com timezone           | ‚úÖ         | <code>src/logger.py</code> com fuso hor√°rio <code>America/Sao_Paulo</code>                |
| Tratamento robusto de erros                | ‚úÖ         | <code>try/except</code> em todos os scripts                                   |
| Testes automatizados e unit√°rios           | ‚úÖ         | <code>tests/test_transform.py</code>, <code>tests/test_gold_quality.py</code>            |
| Verifica√ß√£o de duplicatas e metadados      | ‚úÖ         | <code>check_duplicates_silver.py</code>, <code>verify_gold.py</code>, <code>verify_all.py</code>    |
| EDA para Silver e Gold                     | ‚úÖ         | <code>check_eda_silver.py</code>, <code>check_eda_gold.py</code>                          |
| Containeriza√ß√£o com Docker                 | ‚úÖ         | <code>Dockerfile</code>, <code>docker-compose.yml</code>                                  |
| Makefile de execu√ß√£o                       | ‚úÖ         | <code>Makefile</code> com targets <code>all</code>, <code>eda-silver</code>, <code>eda-gold</code>, etc         |</p>

<hr />

<h2>üóÇÔ∏è Arquitetura Medallion</h2>

<h3>üü´ Bronze</h3>

<ul>
<li>Ingest√£o paginada da API</li>
<li>Salvamento em <code>/data/bronze/&lt;processing_date&gt;/breweries_page_&lt;n&gt;.json</code></li>
</ul>

<h3>üü™ Silver</h3>

<ul>
<li>Leitura resiliente de m√∫ltiplos arquivos JSON</li>
<li>Escrita Delta particionada por <code>processing_date</code> e <code>state</code></li>
<li>Armazenamento: <code>/data/silver/processing_date=.../state=.../</code></li>
</ul>

<h3>üü® Gold</h3>

<ul>
<li>Agrega√ß√µes por <code>state</code> e <code>brewery_type</code>, com <code>brewery_count</code></li>
<li>Escrita Delta com parti√ß√£o em <code>processing_date</code></li>
<li>Armazenamento: <code>/data/gold/processing_date=.../</code></li>
</ul>

<hr />

<h2>üß™ Testes, Verifica√ß√µes e Qualidade</h2>

<ul>
<li><code>pytest</code> com <code>test_transform.py</code>, <code>test_gold_quality.py</code>, <code>test_check_duplicates.py</code></li>
<li><code>check_eda_silver.py</code> e <code>check_eda_gold.py</code> com detec√ß√£o de outliers, nulos, cardinalidade e schema</li>
<li>Valida√ß√µes por script: <code>verify_*.py</code>, <code>check_eda_*.py</code>, <code>check_duplicates_silver.py</code></li>
<li>Execu√ß√£o integrada no <code>verify_all.py</code> com logs limpos (sem emojis)</li>
</ul>

<p><code>bash
make verify
make test
make all
</code></p>

<hr />

<h2>‚öôÔ∏è Execu√ß√£o via Docker (recomendada)</h2>

<p><code>bash
docker compose build
docker compose up -d
</code></p>

<h3>Manual via Docker:</h3>

<p><code>bash
docker exec -e PROCESSING_DATE=2025-07-29 -it spark-container python3 /home/project/scripts/run_bronze.py
docker exec -e CARGA=delta -e PROCESSING_DATE=2025-07-29 -it spark-container python3 /home/project/scripts/run_silver.py
docker exec -e CARGA=delta -e PROCESSING_DATE=2025-07-29 -it spark-container python3 /home/project/scripts/run_gold.py
docker exec -e PROCESSING_DATE=2025-07-29 -it spark-container python3 /home/project/tests/verify_all.py
</code></p>

<hr />

<h2>üéõÔ∏è Airflow</h2>

<p>DAG automatizada em <code>airflow/dags/brewery_dag.py</code>:</p>

<p><code>text
run_bronze -&gt; run_silver -&gt; run_gold -&gt; verify_tests
</code></p>

<hr />

<h2>üßµ Execu√ß√£o local</h2>

<p><code>bash
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
make all
</code></p>

<hr />

<h2>üì¶ Estrutura de Projeto</h2>

<ul>
<li><code>scripts/</code>: scripts <code>run_bronze.py</code>, <code>run_silver.py</code>, <code>run_gold.py</code>, <code>main.py</code></li>
<li><code>src/</code>: fun√ß√µes reutiliz√°veis (<code>logger</code>, <code>transform</code>, <code>api_client</code>)</li>
<li><code>tests/</code>: testes automatizados e de valida√ß√£o</li>
<li><code>data/</code>: estrutura Delta particionada por camada e data</li>
<li><code>airflow/</code>: configura√ß√£o e DAG do Airflow</li>
<li><code>Makefile</code>: targets para facilitar execu√ß√£o local</li>
<li><code>.github/</code>: workflow CI/CD</li>
</ul>

<hr />

<h2>‚úÖ Reposit√≥rio</h2>

<p>https://github.com/a2kr1/bees-breweries-case</p>

<hr />

<h2>üë®‚Äçüíª Autor</h2>

<p><strong>Andr√© Santos</strong><br />
Engenheiro de Dados | <a href="https://github.com/a2kr1">GitHub</a></p>

</main>
<footer>
    <p>*Este documento utiliza a paleta de cores da AB InBev.</p>
</footer>
</body>
</html>
